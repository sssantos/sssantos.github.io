<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Cindy Lai's STA 141B portfolio site">

    <title>Assignment 3 - Cindy Lai's Data Treasure Trove</title>

    <link rel="canonical" href="http://localhost:4000/2017/02/05/a3/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Cindy Lai's Data Treasure Trove" />

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Cindy Lai's Data Treasure Trove</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
				
                <li>
                    <a href="/about/">About</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/forest2.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Assignment 3</h1>
                    
                    <h2 class="subheading">Introduction to Pandas and Dataframes</h2>
                    
                    <span class="meta">Posted by Cindy Lai on February 5, 2017</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<h1 id="assignment-3">Assignment 3</h1>

<p>The US Department of Agriculture publishes price estimates for fruits and vegetables <a href="https://www.ers.usda.gov/data-products/fruit-and-vegetable-prices/fruit-and-vegetable-prices/">online</a>. The most recent estimates are based on a 2013 survey of US retail stores.</p>

<p>The estimates are provided as a collection of MS Excel files, with one file per fruit or vegetable. The <code class="highlighter-rouge">assignment3_data.zip</code> file contains the fruit and vegetable files in the directories <code class="highlighter-rouge">fruit</code> and <code class="highlighter-rouge">vegetables</code>, respectively.</p>

<p><strong>Exercise 1.1.</strong> Use pandas to extract the “Fresh” row(s) from the <strong style="color:#B0B">fruit</strong> Excel files. Combine the data into a single data frame. Your data frame should look something like this:</p>

<table>
  <thead>
    <tr>
      <th>type</th>
      <th>food</th>
      <th>form</th>
      <th>price_per_lb</th>
      <th>yield</th>
      <th>lb_per_cup</th>
      <th>price_per_cup</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>fruit</td>
      <td>watermelon</td>
      <td>Fresh1</td>
      <td>0.333412</td>
      <td>0.52</td>
      <td>0.330693</td>
      <td>0.212033</td>
    </tr>
    <tr>
      <td>fruit</td>
      <td>cantaloupe</td>
      <td>Fresh1</td>
      <td>0.535874</td>
      <td>0.51</td>
      <td>0.374786</td>
      <td>0.3938</td>
    </tr>
    <tr>
      <td>vegetables</td>
      <td>onions</td>
      <td>Fresh1</td>
      <td>1.03811</td>
      <td>0.9</td>
      <td>0.35274</td>
      <td>0.406868</td>
    </tr>
    <tr>
      <td>…</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>It’s okay if the rows and columns of your data frame are in a different order. These modules are especially relevant:</p>

<ul>
  <li><a href="https://docs.python.org/2/library/stdtypes.html#string-methods"><code class="highlighter-rouge">str</code> methods</a></li>
  <li><a href="https://docs.python.org/2/library/os.html"><code class="highlighter-rouge">os</code></a></li>
  <li><a href="https://docs.python.org/2/library/os.path.html"><code class="highlighter-rouge">os.path</code></a></li>
  <li><a href="http://pandas.pydata.org/pandas-docs/stable/">pandas</a>: <code class="highlighter-rouge">read_excel()</code>, <code class="highlighter-rouge">concat()</code>, <code class="highlighter-rouge">.fillna()</code>, <code class="highlighter-rouge">.str</code>, plotting methods</li>
</ul>

<p>Ask questions and search the documentation/web to find the functions you need.</p>

<p>I set the path to the fruit directory and use a list comprehension to get fruit names.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">listdir</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">isfile</span><span class="p">,</span> <span class="n">join</span>

<span class="n">fruit_path</span> <span class="o">=</span> <span class="s">"data/fruit/"</span>

<span class="n">num_files</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fruit_path</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">fruit_path</span><span class="p">))</span>

<span class="n">onlyfiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'.xlsx'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">listdir</span><span class="p">(</span><span class="n">fruit_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">fruit_path</span><span class="p">,</span> <span class="n">f</span><span class="p">))]</span>

<span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="s">"type"</span><span class="p">,</span> <span class="s">"food"</span><span class="p">,</span> <span class="s">"form"</span><span class="p">,</span> <span class="s">"price_per_lb"</span><span class="p">,</span> <span class="s">"yield_v"</span><span class="p">,</span> <span class="s">"lb_per_cup"</span><span class="p">,</span> <span class="s">"price_per_cup"</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">onlyfiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>'apricots'
</code></pre>
</div>

<p>This is the extract function which will read in a fruit (input will be from onlyfiles), and extract specified values. It returns a dictionary.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">extract</span><span class="p">(</span><span class="n">fruit</span><span class="p">):</span>
    <span class="n">bkb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">fruit_path</span> <span class="o">+</span> <span class="n">fruit</span><span class="o">+</span><span class="s">".xlsx"</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">skiprows</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">fresh_row</span> <span class="o">=</span> <span class="n">bkb</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">price_per_lb</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">yield_v</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">lb_per_cup</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">price_per_cup</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">lout</span> <span class="o">=</span> <span class="p">[</span><span class="s">"fruit"</span><span class="p">,</span> <span class="n">fruit</span><span class="p">,</span> <span class="s">"Fresh1"</span> <span class="p">,</span> <span class="n">price_per_lb</span><span class="p">,</span> <span class="n">yield_v</span><span class="p">,</span> <span class="n">lb_per_cup</span><span class="p">,</span> <span class="n">price_per_cup</span><span class="p">]</span>

    <span class="n">dout</span> <span class="o">=</span> <span class="p">{</span><span class="s">"type"</span> <span class="p">:</span> <span class="p">[</span><span class="s">"fruit"</span><span class="p">],</span> <span class="s">"food"</span> <span class="p">:</span> <span class="p">[</span><span class="n">fruit</span><span class="p">],</span> <span class="s">"form"</span><span class="p">:</span> <span class="p">[</span><span class="s">"Fresh1"</span><span class="p">],</span> <span class="s">"price_per_lb"</span> <span class="p">:[</span><span class="n">price_per_lb</span><span class="p">]</span> <span class="p">,</span> <span class="s">"yield_v"</span><span class="p">:[</span><span class="n">yield_v</span><span class="p">],</span> <span class="s">"lb_per_cup"</span><span class="p">:[</span><span class="n">lb_per_cup</span><span class="p">],</span> <span class="s">"price_per_cup"</span><span class="p">:[</span><span class="n">price_per_cup</span><span class="p">]}</span>

    <span class="k">return</span> <span class="n">dout</span>

<span class="n">extract</span><span class="p">(</span><span class="n">onlyfiles</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="err">'food':</span><span class="w"> </span><span class="err">['apricots'],</span><span class="w">
 </span><span class="err">'form':</span><span class="w"> </span><span class="err">['Fresh1'],</span><span class="w">
 </span><span class="err">'lb_per_cup':</span><span class="w"> </span><span class="err">[0.363762732605048],</span><span class="w">
 </span><span class="err">'price_per_cup':</span><span class="w"> </span><span class="err">[1.1891020280290363],</span><span class="w">
 </span><span class="err">'price_per_lb':</span><span class="w"> </span><span class="err">[3.040071967096438],</span><span class="w">
 </span><span class="err">'type':</span><span class="w"> </span><span class="err">['fruit'],</span><span class="w">
 </span><span class="err">'yield_v':</span><span class="w"> </span><span class="err">[0.93]</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>The getFruit function will get all the fruits in the fruit folder and create a data frame out of all the entries.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">getFruit</span><span class="p">(</span><span class="n">fruitList</span><span class="p">):</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fruitList</span><span class="p">:</span>
        <span class="k">if</span> <span class="s">'$'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df2</span>

<span class="n">fruit_df</span> <span class="o">=</span> <span class="n">getFruit</span><span class="p">(</span><span class="n">onlyfiles</span><span class="p">)</span>
<span class="n">fruit_df</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>food</th>
      <th>form</th>
      <th>lb_per_cup</th>
      <th>price_per_cup</th>
      <th>price_per_lb</th>
      <th>type</th>
      <th>yield_v</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apples</td>
      <td>Fresh1</td>
      <td>0.242508</td>
      <td>0.422373</td>
      <td>1.567515</td>
      <td>fruit</td>
      <td>0.90</td>
    </tr>
    <tr>
      <th>0</th>
      <td>apricots</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>1.189102</td>
      <td>3.040072</td>
      <td>fruit</td>
      <td>0.93</td>
    </tr>
    <tr>
      <th>0</th>
      <td>bananas</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>0.292965</td>
      <td>0.566983</td>
      <td>fruit</td>
      <td>0.64</td>
    </tr>
    <tr>
      <th>0</th>
      <td>berries_mixed</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>1.127735</td>
      <td>3.410215</td>
      <td>fruit</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>0</th>
      <td>blackberries</td>
      <td>Fresh1</td>
      <td>0.319670</td>
      <td>1.922919</td>
      <td>5.774708</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>0</th>
      <td>blueberries</td>
      <td>Fresh1</td>
      <td>0.319670</td>
      <td>1.593177</td>
      <td>4.734622</td>
      <td>fruit</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cantaloupe</td>
      <td>Fresh1</td>
      <td>0.374786</td>
      <td>0.393800</td>
      <td>0.535874</td>
      <td>fruit</td>
      <td>0.51</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cherries</td>
      <td>Fresh1</td>
      <td>0.341717</td>
      <td>1.334548</td>
      <td>3.592990</td>
      <td>fruit</td>
      <td>0.92</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cranberries</td>
      <td>Fresh1</td>
      <td>0.123163</td>
      <td>0.589551</td>
      <td>4.786741</td>
      <td>fruit</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>0</th>
      <td>dates</td>
      <td>Fresh1</td>
      <td>0.165347</td>
      <td>0.792234</td>
      <td>4.791351</td>
      <td>fruit</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>0</th>
      <td>figs</td>
      <td>Fresh1</td>
      <td>0.165347</td>
      <td>0.990068</td>
      <td>5.748318</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>0</th>
      <td>fruit_cocktail</td>
      <td>Fresh1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>fruit</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>grapefruit</td>
      <td>Fresh1</td>
      <td>0.462971</td>
      <td>0.848278</td>
      <td>0.897802</td>
      <td>fruit</td>
      <td>0.49</td>
    </tr>
    <tr>
      <th>0</th>
      <td>grapes</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>0.721266</td>
      <td>2.093827</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>0</th>
      <td>honeydew</td>
      <td>Fresh1</td>
      <td>0.374786</td>
      <td>0.649077</td>
      <td>0.796656</td>
      <td>fruit</td>
      <td>0.46</td>
    </tr>
    <tr>
      <th>0</th>
      <td>kiwi</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>1.037970</td>
      <td>2.044683</td>
      <td>fruit</td>
      <td>0.76</td>
    </tr>
    <tr>
      <th>0</th>
      <td>mangoes</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>0.705783</td>
      <td>1.377563</td>
      <td>fruit</td>
      <td>0.71</td>
    </tr>
    <tr>
      <th>0</th>
      <td>nectarines</td>
      <td>Fresh1</td>
      <td>0.319670</td>
      <td>0.618667</td>
      <td>1.761148</td>
      <td>fruit</td>
      <td>0.91</td>
    </tr>
    <tr>
      <th>0</th>
      <td>oranges</td>
      <td>Fresh1</td>
      <td>0.407855</td>
      <td>0.578357</td>
      <td>1.035173</td>
      <td>fruit</td>
      <td>0.73</td>
    </tr>
    <tr>
      <th>0</th>
      <td>papaya</td>
      <td>Fresh1</td>
      <td>0.308647</td>
      <td>0.646174</td>
      <td>1.298012</td>
      <td>fruit</td>
      <td>0.62</td>
    </tr>
    <tr>
      <th>0</th>
      <td>peaches</td>
      <td>Fresh1</td>
      <td>0.341717</td>
      <td>0.566390</td>
      <td>1.591187</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>0</th>
      <td>pears</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>0.590740</td>
      <td>1.461575</td>
      <td>fruit</td>
      <td>0.90</td>
    </tr>
    <tr>
      <th>0</th>
      <td>pineapple</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>0.447686</td>
      <td>0.627662</td>
      <td>fruit</td>
      <td>0.51</td>
    </tr>
    <tr>
      <th>0</th>
      <td>plums</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>0.707176</td>
      <td>1.827416</td>
      <td>fruit</td>
      <td>0.94</td>
    </tr>
    <tr>
      <th>0</th>
      <td>pomegranate</td>
      <td>Fresh1</td>
      <td>0.341717</td>
      <td>1.326342</td>
      <td>2.173590</td>
      <td>fruit</td>
      <td>0.56</td>
    </tr>
    <tr>
      <th>0</th>
      <td>raspberries</td>
      <td>Fresh1</td>
      <td>0.319670</td>
      <td>2.322874</td>
      <td>6.975811</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>0</th>
      <td>strawberries</td>
      <td>Fresh1</td>
      <td>0.319670</td>
      <td>0.802171</td>
      <td>2.358808</td>
      <td>fruit</td>
      <td>0.94</td>
    </tr>
    <tr>
      <th>0</th>
      <td>tangerines</td>
      <td>Fresh1</td>
      <td>0.407855</td>
      <td>0.759471</td>
      <td>1.377962</td>
      <td>fruit</td>
      <td>0.74</td>
    </tr>
    <tr>
      <th>0</th>
      <td>watermelon</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>0.212033</td>
      <td>0.333412</td>
      <td>fruit</td>
      <td>0.52</td>
    </tr>
  </tbody>
</table>
</div>

<p><strong>Exercise 1.2.</strong> Reuse your code from exercise 1.1 to extract the “Fresh” row(s) from the <strong style="color:#B0B">vegetable</strong> Excel files.</p>

<p>Does your code produce the correct prices for tomatoes? If not, why not? Do any other files have the same problem as the tomatoes file?</p>

<p>You don’t need to extract the prices for these problem files. However, make sure the prices are extracted for files like asparagus that don’t have this problem.</p>

<p>Using the same code for fruit, I simply change the path to vegetables.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">vegetable_path</span> <span class="o">=</span> <span class="s">"data/vegetables/"</span>

<span class="n">onlyfiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'.xlsx'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">listdir</span><span class="p">(</span><span class="n">vegetable_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">vegetable_path</span><span class="p">,</span> <span class="n">f</span><span class="p">))]</span>


<span class="k">def</span> <span class="nf">extract</span><span class="p">(</span><span class="n">vegetable</span><span class="p">):</span>
    <span class="n">bkb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">vegetable_path</span> <span class="o">+</span> <span class="n">vegetable</span><span class="o">+</span><span class="s">".xlsx"</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">skiprows</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">fresh_row</span> <span class="o">=</span> <span class="n">bkb</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">price_per_lb</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">yield_v</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">lb_per_cup</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">price_per_cup</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>

    <span class="n">dout</span> <span class="o">=</span> <span class="p">{</span><span class="s">"type"</span> <span class="p">:</span> <span class="p">[</span><span class="s">"vegetable"</span><span class="p">],</span> <span class="s">"food"</span> <span class="p">:</span> <span class="p">[</span><span class="n">vegetable</span><span class="p">],</span> <span class="s">"form"</span><span class="p">:</span> <span class="p">[</span><span class="s">"Fresh1"</span><span class="p">],</span> <span class="s">"price_per_lb"</span> <span class="p">:[</span><span class="n">price_per_lb</span><span class="p">]</span> <span class="p">,</span> <span class="s">"yield_v"</span><span class="p">:[</span><span class="n">yield_v</span><span class="p">],</span> <span class="s">"lb_per_cup"</span><span class="p">:[</span><span class="n">lb_per_cup</span><span class="p">],</span> <span class="s">"price_per_cup"</span><span class="p">:[</span><span class="n">price_per_cup</span><span class="p">]}</span>

    <span class="s">'''
    vegetableSeries = pd.Series(data=["vegetable", vegetable, "Fresh1", price_per_lb, yield_v, lb_per_cup, price_per_cup], name = vegetable)
    return vegetableSeries
    '''</span>
    <span class="k">return</span> <span class="n">dout</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">extract</span><span class="p">(</span><span class="n">onlyfiles</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="err">'food':</span><span class="w"> </span><span class="err">['artichoke'],</span><span class="w">
 </span><span class="err">'form':</span><span class="w"> </span><span class="err">['Fresh1'],</span><span class="w">
 </span><span class="err">'lb_per_cup':</span><span class="w"> </span><span class="err">[0.38580895882353577],</span><span class="w">
 </span><span class="err">'price_per_cup':</span><span class="w"> </span><span class="err">[2.2749668026387808],</span><span class="w">
 </span><span class="err">'price_per_lb':</span><span class="w"> </span><span class="err">[2.2130504792860322],</span><span class="w">
 </span><span class="err">'type':</span><span class="w"> </span><span class="err">['vegetable'],</span><span class="w">
 </span><span class="err">'yield_v':</span><span class="w"> </span><span class="err">[0.37530864197530867]</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">getVegetable</span><span class="p">(</span><span class="n">vegetableList</span><span class="p">):</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">vegetableList</span><span class="p">:</span>
        <span class="k">if</span> <span class="s">'$'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df2</span>

<span class="n">vegetable_df</span> <span class="o">=</span> <span class="n">getVegetable</span><span class="p">(</span><span class="n">onlyfiles</span><span class="p">)</span>
<span class="n">vegetable_df</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>food</th>
      <th>form</th>
      <th>lb_per_cup</th>
      <th>price_per_cup</th>
      <th>price_per_lb</th>
      <th>type</th>
      <th>yield_v</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>acorn_squash</td>
      <td>Fresh1</td>
      <td>0.451948</td>
      <td>1.155360</td>
      <td>1.17225</td>
      <td>vegetable</td>
      <td>0.458554</td>
    </tr>
    <tr>
      <th>0</th>
      <td>artichoke</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>2.274967</td>
      <td>2.21305</td>
      <td>vegetable</td>
      <td>0.375309</td>
    </tr>
    <tr>
      <th>0</th>
      <td>asparagus</td>
      <td>Fresh1</td>
      <td>0.396832</td>
      <td>2.582272</td>
      <td>3.21349</td>
      <td>vegetable</td>
      <td>0.493835</td>
    </tr>
    <tr>
      <th>0</th>
      <td>avocados</td>
      <td>Fresh1</td>
      <td>0.31967</td>
      <td>0.964886</td>
      <td>2.23587</td>
      <td>vegetable</td>
      <td>0.740753</td>
    </tr>
    <tr>
      <th>0</th>
      <td>beets</td>
      <td>Fresh1</td>
      <td>0.374786</td>
      <td>0.586555</td>
      <td>1.01728</td>
      <td>vegetable</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>blackeye_peas</td>
      <td>Fresh1</td>
      <td>0.374786</td>
      <td>0.524954</td>
      <td>0.910441</td>
      <td>vegetable</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>black_beans</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>0.582025</td>
      <td>0.98058</td>
      <td>vegetable</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>broccoli</td>
      <td>Fresh1</td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td>vegetable</td>
      <td></td>
    </tr>
    <tr>
      <th>0</th>
      <td>brussels_sprouts</td>
      <td>Fresh1</td>
      <td>0.341717</td>
      <td>0.890898</td>
      <td>2.76355</td>
      <td>vegetable</td>
      <td>1.06</td>
    </tr>
    <tr>
      <th>0</th>
      <td>butternut_squash</td>
      <td>Fresh1</td>
      <td>0.451948</td>
      <td>0.787893</td>
      <td>1.24474</td>
      <td>vegetable</td>
      <td>0.714</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cabbage</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>0.245944</td>
      <td>0.579208</td>
      <td>vegetable</td>
      <td>0.778797</td>
    </tr>
    <tr>
      <th>0</th>
      <td>carrots</td>
      <td>Fresh1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>vegetable</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cauliflower</td>
      <td>Fresh1</td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td>vegetable</td>
      <td></td>
    </tr>
    <tr>
      <th>0</th>
      <td>celery</td>
      <td>Fresh1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>vegetable</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>collard_greens</td>
      <td>Fresh1</td>
      <td>0.286601</td>
      <td>0.650001</td>
      <td>2.63084</td>
      <td>vegetable</td>
      <td>1.16</td>
    </tr>
    <tr>
      <th>0</th>
      <td>corn_sweet</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>1.812497</td>
      <td>2.69062</td>
      <td>vegetable</td>
      <td>0.54</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cucumbers</td>
      <td>Fresh1</td>
      <td>0.264555</td>
      <td>0.353448</td>
      <td>1.29593</td>
      <td>vegetable</td>
      <td>0.97</td>
    </tr>
    <tr>
      <th>0</th>
      <td>great_northern_beans</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>0.548392</td>
      <td>0.923916</td>
      <td>vegetable</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>green_beans</td>
      <td>Fresh1</td>
      <td>0.275578</td>
      <td>0.696606</td>
      <td>2.13997</td>
      <td>vegetable</td>
      <td>0.846575</td>
    </tr>
    <tr>
      <th>0</th>
      <td>green_peas</td>
      <td>Fresh1</td>
      <td>0.35274</td>
      <td>0.549769</td>
      <td>1.01307</td>
      <td>vegetable</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>green_peppers</td>
      <td>Fresh1</td>
      <td>0.264555</td>
      <td>0.455022</td>
      <td>1.41036</td>
      <td>vegetable</td>
      <td>0.82</td>
    </tr>
    <tr>
      <th>0</th>
      <td>kale</td>
      <td>Fresh1</td>
      <td>0.286601</td>
      <td>0.766262</td>
      <td>2.8073</td>
      <td>vegetable</td>
      <td>1.05</td>
    </tr>
    <tr>
      <th>0</th>
      <td>kidney_beans</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>0.535194</td>
      <td>0.90168</td>
      <td>vegetable</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>lentils</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>0.196738</td>
      <td>1.38504</td>
      <td>vegetable</td>
      <td>2.7161</td>
    </tr>
    <tr>
      <th>0</th>
      <td>lettuce_iceberg</td>
      <td>Fresh1</td>
      <td>0.242508</td>
      <td>0.309655</td>
      <td>1.21304</td>
      <td>vegetable</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>0</th>
      <td>lettuce_romaine</td>
      <td>Fresh1</td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td>vegetable</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>lima_beans</td>
      <td>Fresh1</td>
      <td>0.374786</td>
      <td>0.797757</td>
      <td>1.38357</td>
      <td>vegetable</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>mixed_vegetables</td>
      <td>Fresh1</td>
      <td></td>
      <td>NaN</td>
      <td></td>
      <td>vegetable</td>
      <td></td>
    </tr>
    <tr>
      <th>0</th>
      <td>mushrooms</td>
      <td>Fresh1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>vegetable</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>mustard_greens</td>
      <td>Fresh1</td>
      <td>0.308647</td>
      <td>0.944032</td>
      <td>2.56924</td>
      <td>vegetable</td>
      <td>0.84</td>
    </tr>
    <tr>
      <th>0</th>
      <td>navy_beans</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>0.575997</td>
      <td>0.970423</td>
      <td>vegetable</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>okra</td>
      <td>Fresh1</td>
      <td>0.35274</td>
      <td>1.473146</td>
      <td>3.21355</td>
      <td>vegetable</td>
      <td>0.769474</td>
    </tr>
    <tr>
      <th>0</th>
      <td>olives</td>
      <td>Fresh1</td>
      <td>0.297624</td>
      <td>1.246102</td>
      <td>4.18683</td>
      <td>vegetable</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>onions</td>
      <td>Fresh1</td>
      <td>0.35274</td>
      <td>0.406868</td>
      <td>1.03811</td>
      <td>vegetable</td>
      <td>0.9</td>
    </tr>
    <tr>
      <th>0</th>
      <td>pinto_beans</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>0.514129</td>
      <td>0.86619</td>
      <td>vegetable</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>potatoes</td>
      <td>Fresh1</td>
      <td>0.264555</td>
      <td>0.184017</td>
      <td>0.56432</td>
      <td>vegetable</td>
      <td>0.811301</td>
    </tr>
    <tr>
      <th>0</th>
      <td>pumpkin</td>
      <td>Fresh1</td>
      <td>0.540133</td>
      <td>0.730411</td>
      <td>1.35228</td>
      <td>vegetable</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>radish</td>
      <td>Fresh1</td>
      <td>0.275578</td>
      <td>0.401618</td>
      <td>1.31163</td>
      <td>vegetable</td>
      <td>0.9</td>
    </tr>
    <tr>
      <th>0</th>
      <td>red_peppers</td>
      <td>Fresh1</td>
      <td>0.264555</td>
      <td>0.734926</td>
      <td>2.27794</td>
      <td>vegetable</td>
      <td>0.82</td>
    </tr>
    <tr>
      <th>0</th>
      <td>spinach</td>
      <td>Fresh1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>vegetable</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>summer_squash</td>
      <td>Fresh1</td>
      <td>0.396832</td>
      <td>0.845480</td>
      <td>1.63948</td>
      <td>vegetable</td>
      <td>0.7695</td>
    </tr>
    <tr>
      <th>0</th>
      <td>sweet_potatoes</td>
      <td>Fresh1</td>
      <td>0.440925</td>
      <td>0.499400</td>
      <td>0.918897</td>
      <td>vegetable</td>
      <td>0.811301</td>
    </tr>
    <tr>
      <th>0</th>
      <td>tomatoes</td>
      <td>Fresh1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>vegetable</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>turnip_greens</td>
      <td>Fresh1</td>
      <td>0.31967</td>
      <td>1.053526</td>
      <td>2.47175</td>
      <td>vegetable</td>
      <td>0.75</td>
    </tr>
  </tbody>
</table>
</div>

<p>The tomatoes entry does not have the correct information (it displays NaN for all its rows instead).
Broccoli, celery, carrots, cauliflower, romaine lettuce, mixed vegetables, mushrooms, and spinach also have NaN values.</p>

<p>This is because these entries have nothing on the row which is labeled “Fresh”. There are different types of those vegetables which are sold at different prices.</p>

<p><strong>Exercise 1.3.</strong> Remove rows without a price from the vegetable data frame and then combine the fruit and vegetable data frames. Make sure all columns of numbers are numeric (not strings).</p>

<p>I now combine the vegetable and fruit files into one data frame. I then clean for invalid entries.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">vegetable_path</span> <span class="o">=</span> <span class="s">"data/vegetables/"</span>
<span class="n">fruit_path</span> <span class="o">=</span> <span class="s">"data/fruit/"</span>

<span class="n">num_files</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vegetable_path</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">vegetable_path</span><span class="p">))</span>

<span class="n">vegetableFiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'.xlsx'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">listdir</span><span class="p">(</span><span class="n">vegetable_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">vegetable_path</span><span class="p">,</span> <span class="n">f</span><span class="p">))]</span>
<span class="n">fruitFiles</span>  <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'.xlsx'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">listdir</span><span class="p">(</span><span class="n">fruit_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">fruit_path</span><span class="p">,</span> <span class="n">f</span><span class="p">))]</span>

<span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="s">"type"</span><span class="p">,</span> <span class="s">"food"</span><span class="p">,</span> <span class="s">"form"</span><span class="p">,</span> <span class="s">"price_per_lb"</span><span class="p">,</span> <span class="s">"yield_v"</span><span class="p">,</span> <span class="s">"lb_per_cup"</span><span class="p">,</span> <span class="s">"price_per_cup"</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c">#extract function, works for both fruits and veggies</span>
<span class="k">def</span> <span class="nf">extract</span><span class="p">(</span><span class="n">typeO</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="n">bkb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">obj</span><span class="o">+</span><span class="s">".xlsx"</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">skiprows</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">fresh_row</span> <span class="o">=</span> <span class="n">bkb</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">price_per_lb</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">yield_v</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">lb_per_cup</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">price_per_cup</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">dout</span> <span class="o">=</span> <span class="p">{</span><span class="s">"type"</span> <span class="p">:</span> <span class="p">[</span><span class="n">typeO</span><span class="p">],</span> <span class="s">"food"</span> <span class="p">:</span> <span class="p">[</span><span class="n">obj</span><span class="p">],</span> <span class="s">"form"</span><span class="p">:</span> <span class="p">[</span><span class="s">"Fresh1"</span><span class="p">],</span> <span class="s">"price_per_lb"</span> <span class="p">:[</span><span class="n">price_per_lb</span><span class="p">]</span> <span class="p">,</span> <span class="s">"yield_v"</span><span class="p">:[</span><span class="n">yield_v</span><span class="p">],</span> <span class="s">"lb_per_cup"</span><span class="p">:[</span><span class="n">lb_per_cup</span><span class="p">],</span> <span class="s">"price_per_cup"</span><span class="p">:[</span><span class="n">price_per_cup</span><span class="p">]}</span>

    <span class="k">return</span> <span class="n">dout</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">#extract function, works for both fruits and veggies</span>
<span class="k">def</span> <span class="nf">extract</span><span class="p">(</span><span class="n">typeO</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="n">bkb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">obj</span><span class="o">+</span><span class="s">".xlsx"</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">skiprows</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">fresh_row</span> <span class="o">=</span> <span class="n">bkb</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">price_per_lb</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">yield_v</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">lb_per_cup</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">price_per_cup</span> <span class="o">=</span> <span class="n">fresh_row</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">dout</span> <span class="o">=</span> <span class="p">{</span><span class="s">"type"</span> <span class="p">:</span> <span class="p">[</span><span class="n">typeO</span><span class="p">],</span> <span class="s">"food"</span> <span class="p">:</span> <span class="p">[</span><span class="n">obj</span><span class="p">],</span> <span class="s">"form"</span><span class="p">:</span> <span class="p">[</span><span class="s">"Fresh1"</span><span class="p">],</span> <span class="s">"price_per_lb"</span> <span class="p">:[</span><span class="n">price_per_lb</span><span class="p">]</span> <span class="p">,</span> <span class="s">"yield_v"</span><span class="p">:[</span><span class="n">yield_v</span><span class="p">],</span> <span class="s">"lb_per_cup"</span><span class="p">:[</span><span class="n">lb_per_cup</span><span class="p">],</span> <span class="s">"price_per_cup"</span><span class="p">:[</span><span class="n">price_per_cup</span><span class="p">]}</span>

    <span class="k">return</span> <span class="n">dout</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">#returns combined dataframe of both fruits and veggies</span>
<span class="k">def</span> <span class="nf">getBoth</span><span class="p">(</span><span class="n">fruitList</span><span class="p">,</span> <span class="n">vegetableList</span><span class="p">):</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fruitList</span><span class="p">:</span>
        <span class="k">if</span> <span class="s">'$'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="s">"fruit"</span><span class="p">,</span> <span class="n">fruit_path</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">vegetableList</span><span class="p">:</span>
         <span class="k">if</span> <span class="s">'$'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="s">"vegetables"</span><span class="p">,</span> <span class="n">vegetable_path</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>

    <span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df2</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">getBoth</span><span class="p">(</span><span class="n">fruitFiles</span><span class="p">,</span> <span class="n">vegetableFiles</span><span class="p">)</span>
<span class="n">merged_df</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>food</th>
      <th>form</th>
      <th>lb_per_cup</th>
      <th>price_per_cup</th>
      <th>price_per_lb</th>
      <th>type</th>
      <th>yield_v</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apples</td>
      <td>Fresh1</td>
      <td>0.242508</td>
      <td>0.422373</td>
      <td>1.56752</td>
      <td>fruit</td>
      <td>0.9</td>
    </tr>
    <tr>
      <th>0</th>
      <td>apricots</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>1.189102</td>
      <td>3.04007</td>
      <td>fruit</td>
      <td>0.93</td>
    </tr>
    <tr>
      <th>0</th>
      <td>bananas</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>0.292965</td>
      <td>0.566983</td>
      <td>fruit</td>
      <td>0.64</td>
    </tr>
    <tr>
      <th>0</th>
      <td>berries_mixed</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>1.127735</td>
      <td>3.41021</td>
      <td>fruit</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>blackberries</td>
      <td>Fresh1</td>
      <td>0.31967</td>
      <td>1.922919</td>
      <td>5.77471</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
  </tbody>
</table>
</div>

<p>I now clean the data to remove invalid rows.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">cleanData</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">'ignore'</span><span class="p">))</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">notnull</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s">'price_per_lb'</span><span class="p">])]</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">notnull</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s">'price_per_cup'</span><span class="p">])]</span>
    <span class="k">return</span> <span class="n">df2</span>

<span class="n">clean_df</span> <span class="o">=</span> <span class="n">cleanData</span><span class="p">(</span><span class="n">merged_df</span><span class="p">)</span>
<span class="n">clean_df</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>food</th>
      <th>form</th>
      <th>lb_per_cup</th>
      <th>price_per_cup</th>
      <th>price_per_lb</th>
      <th>type</th>
      <th>yield_v</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apples</td>
      <td>Fresh1</td>
      <td>0.242508</td>
      <td>0.422373</td>
      <td>1.56752</td>
      <td>fruit</td>
      <td>0.9</td>
    </tr>
    <tr>
      <th>0</th>
      <td>apricots</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>1.189102</td>
      <td>3.04007</td>
      <td>fruit</td>
      <td>0.93</td>
    </tr>
    <tr>
      <th>0</th>
      <td>bananas</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>0.292965</td>
      <td>0.566983</td>
      <td>fruit</td>
      <td>0.64</td>
    </tr>
    <tr>
      <th>0</th>
      <td>berries_mixed</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>1.127735</td>
      <td>3.41021</td>
      <td>fruit</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>blackberries</td>
      <td>Fresh1</td>
      <td>0.31967</td>
      <td>1.922919</td>
      <td>5.77471</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>0</th>
      <td>blueberries</td>
      <td>Fresh1</td>
      <td>0.31967</td>
      <td>1.593177</td>
      <td>4.73462</td>
      <td>fruit</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cantaloupe</td>
      <td>Fresh1</td>
      <td>0.374786</td>
      <td>0.393800</td>
      <td>0.535874</td>
      <td>fruit</td>
      <td>0.51</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cherries</td>
      <td>Fresh1</td>
      <td>0.341717</td>
      <td>1.334548</td>
      <td>3.59299</td>
      <td>fruit</td>
      <td>0.92</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cranberries</td>
      <td>Fresh1</td>
      <td>0.123163</td>
      <td>0.589551</td>
      <td>4.78674</td>
      <td>fruit</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>dates</td>
      <td>Fresh1</td>
      <td>0.165347</td>
      <td>0.792234</td>
      <td>4.79135</td>
      <td>fruit</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>figs</td>
      <td>Fresh1</td>
      <td>0.165347</td>
      <td>0.990068</td>
      <td>5.74832</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>0</th>
      <td>grapefruit</td>
      <td>Fresh1</td>
      <td>0.462971</td>
      <td>0.848278</td>
      <td>0.897802</td>
      <td>fruit</td>
      <td>0.49</td>
    </tr>
    <tr>
      <th>0</th>
      <td>grapes</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>0.721266</td>
      <td>2.09383</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>0</th>
      <td>honeydew</td>
      <td>Fresh1</td>
      <td>0.374786</td>
      <td>0.649077</td>
      <td>0.796656</td>
      <td>fruit</td>
      <td>0.46</td>
    </tr>
    <tr>
      <th>0</th>
      <td>kiwi</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>1.037970</td>
      <td>2.04468</td>
      <td>fruit</td>
      <td>0.76</td>
    </tr>
    <tr>
      <th>0</th>
      <td>mangoes</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>0.705783</td>
      <td>1.37756</td>
      <td>fruit</td>
      <td>0.71</td>
    </tr>
    <tr>
      <th>0</th>
      <td>nectarines</td>
      <td>Fresh1</td>
      <td>0.31967</td>
      <td>0.618667</td>
      <td>1.76115</td>
      <td>fruit</td>
      <td>0.91</td>
    </tr>
    <tr>
      <th>0</th>
      <td>oranges</td>
      <td>Fresh1</td>
      <td>0.407855</td>
      <td>0.578357</td>
      <td>1.03517</td>
      <td>fruit</td>
      <td>0.73</td>
    </tr>
    <tr>
      <th>0</th>
      <td>papaya</td>
      <td>Fresh1</td>
      <td>0.308647</td>
      <td>0.646174</td>
      <td>1.29801</td>
      <td>fruit</td>
      <td>0.62</td>
    </tr>
    <tr>
      <th>0</th>
      <td>peaches</td>
      <td>Fresh1</td>
      <td>0.341717</td>
      <td>0.566390</td>
      <td>1.59119</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>0</th>
      <td>pears</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>0.590740</td>
      <td>1.46157</td>
      <td>fruit</td>
      <td>0.9</td>
    </tr>
    <tr>
      <th>0</th>
      <td>pineapple</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>0.447686</td>
      <td>0.627662</td>
      <td>fruit</td>
      <td>0.51</td>
    </tr>
    <tr>
      <th>0</th>
      <td>plums</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>0.707176</td>
      <td>1.82742</td>
      <td>fruit</td>
      <td>0.94</td>
    </tr>
    <tr>
      <th>0</th>
      <td>pomegranate</td>
      <td>Fresh1</td>
      <td>0.341717</td>
      <td>1.326342</td>
      <td>2.17359</td>
      <td>fruit</td>
      <td>0.56</td>
    </tr>
    <tr>
      <th>0</th>
      <td>raspberries</td>
      <td>Fresh1</td>
      <td>0.31967</td>
      <td>2.322874</td>
      <td>6.97581</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>0</th>
      <td>strawberries</td>
      <td>Fresh1</td>
      <td>0.31967</td>
      <td>0.802171</td>
      <td>2.35881</td>
      <td>fruit</td>
      <td>0.94</td>
    </tr>
    <tr>
      <th>0</th>
      <td>tangerines</td>
      <td>Fresh1</td>
      <td>0.407855</td>
      <td>0.759471</td>
      <td>1.37796</td>
      <td>fruit</td>
      <td>0.74</td>
    </tr>
    <tr>
      <th>0</th>
      <td>watermelon</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>0.212033</td>
      <td>0.333412</td>
      <td>fruit</td>
      <td>0.52</td>
    </tr>
    <tr>
      <th>0</th>
      <td>acorn_squash</td>
      <td>Fresh1</td>
      <td>0.451948</td>
      <td>1.155360</td>
      <td>1.17225</td>
      <td>vegetables</td>
      <td>0.458554</td>
    </tr>
    <tr>
      <th>0</th>
      <td>artichoke</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>2.274967</td>
      <td>2.21305</td>
      <td>vegetables</td>
      <td>0.375309</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>blackeye_peas</td>
      <td>Fresh1</td>
      <td>0.374786</td>
      <td>0.524954</td>
      <td>0.910441</td>
      <td>vegetables</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>black_beans</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>0.582025</td>
      <td>0.98058</td>
      <td>vegetables</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>brussels_sprouts</td>
      <td>Fresh1</td>
      <td>0.341717</td>
      <td>0.890898</td>
      <td>2.76355</td>
      <td>vegetables</td>
      <td>1.06</td>
    </tr>
    <tr>
      <th>0</th>
      <td>butternut_squash</td>
      <td>Fresh1</td>
      <td>0.451948</td>
      <td>0.787893</td>
      <td>1.24474</td>
      <td>vegetables</td>
      <td>0.714</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cabbage</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>0.245944</td>
      <td>0.579208</td>
      <td>vegetables</td>
      <td>0.778797</td>
    </tr>
    <tr>
      <th>0</th>
      <td>collard_greens</td>
      <td>Fresh1</td>
      <td>0.286601</td>
      <td>0.650001</td>
      <td>2.63084</td>
      <td>vegetables</td>
      <td>1.16</td>
    </tr>
    <tr>
      <th>0</th>
      <td>corn_sweet</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>1.812497</td>
      <td>2.69062</td>
      <td>vegetables</td>
      <td>0.54</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cucumbers</td>
      <td>Fresh1</td>
      <td>0.264555</td>
      <td>0.353448</td>
      <td>1.29593</td>
      <td>vegetables</td>
      <td>0.97</td>
    </tr>
    <tr>
      <th>0</th>
      <td>great_northern_beans</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>0.548392</td>
      <td>0.923916</td>
      <td>vegetables</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>green_beans</td>
      <td>Fresh1</td>
      <td>0.275578</td>
      <td>0.696606</td>
      <td>2.13997</td>
      <td>vegetables</td>
      <td>0.846575</td>
    </tr>
    <tr>
      <th>0</th>
      <td>green_peas</td>
      <td>Fresh1</td>
      <td>0.35274</td>
      <td>0.549769</td>
      <td>1.01307</td>
      <td>vegetables</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>green_peppers</td>
      <td>Fresh1</td>
      <td>0.264555</td>
      <td>0.455022</td>
      <td>1.41036</td>
      <td>vegetables</td>
      <td>0.82</td>
    </tr>
    <tr>
      <th>0</th>
      <td>kale</td>
      <td>Fresh1</td>
      <td>0.286601</td>
      <td>0.766262</td>
      <td>2.8073</td>
      <td>vegetables</td>
      <td>1.05</td>
    </tr>
    <tr>
      <th>0</th>
      <td>kidney_beans</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>0.535194</td>
      <td>0.90168</td>
      <td>vegetables</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>lentils</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>0.196738</td>
      <td>1.38504</td>
      <td>vegetables</td>
      <td>2.7161</td>
    </tr>
    <tr>
      <th>0</th>
      <td>lettuce_iceberg</td>
      <td>Fresh1</td>
      <td>0.242508</td>
      <td>0.309655</td>
      <td>1.21304</td>
      <td>vegetables</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>0</th>
      <td>lima_beans</td>
      <td>Fresh1</td>
      <td>0.374786</td>
      <td>0.797757</td>
      <td>1.38357</td>
      <td>vegetables</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>mustard_greens</td>
      <td>Fresh1</td>
      <td>0.308647</td>
      <td>0.944032</td>
      <td>2.56924</td>
      <td>vegetables</td>
      <td>0.84</td>
    </tr>
    <tr>
      <th>0</th>
      <td>navy_beans</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>0.575997</td>
      <td>0.970423</td>
      <td>vegetables</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>okra</td>
      <td>Fresh1</td>
      <td>0.35274</td>
      <td>1.473146</td>
      <td>3.21355</td>
      <td>vegetables</td>
      <td>0.769474</td>
    </tr>
    <tr>
      <th>0</th>
      <td>olives</td>
      <td>Fresh1</td>
      <td>0.297624</td>
      <td>1.246102</td>
      <td>4.18683</td>
      <td>vegetables</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>onions</td>
      <td>Fresh1</td>
      <td>0.35274</td>
      <td>0.406868</td>
      <td>1.03811</td>
      <td>vegetables</td>
      <td>0.9</td>
    </tr>
    <tr>
      <th>0</th>
      <td>pinto_beans</td>
      <td>Fresh1</td>
      <td>0.385809</td>
      <td>0.514129</td>
      <td>0.86619</td>
      <td>vegetables</td>
      <td>0.65</td>
    </tr>
    <tr>
      <th>0</th>
      <td>potatoes</td>
      <td>Fresh1</td>
      <td>0.264555</td>
      <td>0.184017</td>
      <td>0.56432</td>
      <td>vegetables</td>
      <td>0.811301</td>
    </tr>
    <tr>
      <th>0</th>
      <td>pumpkin</td>
      <td>Fresh1</td>
      <td>0.540133</td>
      <td>0.730411</td>
      <td>1.35228</td>
      <td>vegetables</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>radish</td>
      <td>Fresh1</td>
      <td>0.275578</td>
      <td>0.401618</td>
      <td>1.31163</td>
      <td>vegetables</td>
      <td>0.9</td>
    </tr>
    <tr>
      <th>0</th>
      <td>red_peppers</td>
      <td>Fresh1</td>
      <td>0.264555</td>
      <td>0.734926</td>
      <td>2.27794</td>
      <td>vegetables</td>
      <td>0.82</td>
    </tr>
    <tr>
      <th>0</th>
      <td>summer_squash</td>
      <td>Fresh1</td>
      <td>0.396832</td>
      <td>0.845480</td>
      <td>1.63948</td>
      <td>vegetables</td>
      <td>0.7695</td>
    </tr>
    <tr>
      <th>0</th>
      <td>sweet_potatoes</td>
      <td>Fresh1</td>
      <td>0.440925</td>
      <td>0.499400</td>
      <td>0.918897</td>
      <td>vegetables</td>
      <td>0.811301</td>
    </tr>
    <tr>
      <th>0</th>
      <td>turnip_greens</td>
      <td>Fresh1</td>
      <td>0.31967</td>
      <td>1.053526</td>
      <td>2.47175</td>
      <td>vegetables</td>
      <td>0.75</td>
    </tr>
  </tbody>
</table>
<p>63 rows × 7 columns</p>
</div>

<p><strong>Exercise 1.4.</strong> Discuss the questions below (a paragraph each is sufficient). Use plots to support your ideas.</p>

<ul>
  <li>What kinds of fruits are the most expensive (per pound)? What kinds are the least expensive?</li>
  <li>How do the price distributions compare for fruit and vegetables?</li>
  <li>Which foods are the best value for the price?</li>
  <li>What’s something surprising about this data set?</li>
  <li>Which foods do you expect to provide the best combination of price, yield, and nutrition? A future assignment may combine this data set with another so you can check your hypothesis.</li>
</ul>

<ol>
  <li>Most expensive fruits are the berries (raspberries, blackberries, cranberries, blueberries) and figs/dates. The least expensive are bananas, watermelon, cantalope, and pineapple.</li>
</ol>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">fruit_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s">'price_per_lb'</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)[:</span><span class="mi">9</span><span class="p">]</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>food</th>
      <th>form</th>
      <th>lb_per_cup</th>
      <th>price_per_cup</th>
      <th>price_per_lb</th>
      <th>type</th>
      <th>yield_v</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>raspberries</td>
      <td>Fresh1</td>
      <td>0.319670</td>
      <td>2.322874</td>
      <td>6.975811</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>0</th>
      <td>blackberries</td>
      <td>Fresh1</td>
      <td>0.319670</td>
      <td>1.922919</td>
      <td>5.774708</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>0</th>
      <td>figs</td>
      <td>Fresh1</td>
      <td>0.165347</td>
      <td>0.990068</td>
      <td>5.748318</td>
      <td>fruit</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>0</th>
      <td>dates</td>
      <td>Fresh1</td>
      <td>0.165347</td>
      <td>0.792234</td>
      <td>4.791351</td>
      <td>fruit</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cranberries</td>
      <td>Fresh1</td>
      <td>0.123163</td>
      <td>0.589551</td>
      <td>4.786741</td>
      <td>fruit</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>0</th>
      <td>blueberries</td>
      <td>Fresh1</td>
      <td>0.319670</td>
      <td>1.593177</td>
      <td>4.734622</td>
      <td>fruit</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cherries</td>
      <td>Fresh1</td>
      <td>0.341717</td>
      <td>1.334548</td>
      <td>3.592990</td>
      <td>fruit</td>
      <td>0.92</td>
    </tr>
    <tr>
      <th>0</th>
      <td>berries_mixed</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>1.127735</td>
      <td>3.410215</td>
      <td>fruit</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>0</th>
      <td>apricots</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>1.189102</td>
      <td>3.040072</td>
      <td>fruit</td>
      <td>0.93</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">fruit_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s">'price_per_lb'</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)[:</span><span class="mi">9</span><span class="p">]</span>
</code></pre>
</div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>food</th>
      <th>form</th>
      <th>lb_per_cup</th>
      <th>price_per_cup</th>
      <th>price_per_lb</th>
      <th>type</th>
      <th>yield_v</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>watermelon</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>0.212033</td>
      <td>0.333412</td>
      <td>fruit</td>
      <td>0.52</td>
    </tr>
    <tr>
      <th>0</th>
      <td>cantaloupe</td>
      <td>Fresh1</td>
      <td>0.374786</td>
      <td>0.393800</td>
      <td>0.535874</td>
      <td>fruit</td>
      <td>0.51</td>
    </tr>
    <tr>
      <th>0</th>
      <td>bananas</td>
      <td>Fresh1</td>
      <td>0.330693</td>
      <td>0.292965</td>
      <td>0.566983</td>
      <td>fruit</td>
      <td>0.64</td>
    </tr>
    <tr>
      <th>0</th>
      <td>pineapple</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>0.447686</td>
      <td>0.627662</td>
      <td>fruit</td>
      <td>0.51</td>
    </tr>
    <tr>
      <th>0</th>
      <td>honeydew</td>
      <td>Fresh1</td>
      <td>0.374786</td>
      <td>0.649077</td>
      <td>0.796656</td>
      <td>fruit</td>
      <td>0.46</td>
    </tr>
    <tr>
      <th>0</th>
      <td>grapefruit</td>
      <td>Fresh1</td>
      <td>0.462971</td>
      <td>0.848278</td>
      <td>0.897802</td>
      <td>fruit</td>
      <td>0.49</td>
    </tr>
    <tr>
      <th>0</th>
      <td>oranges</td>
      <td>Fresh1</td>
      <td>0.407855</td>
      <td>0.578357</td>
      <td>1.035173</td>
      <td>fruit</td>
      <td>0.73</td>
    </tr>
    <tr>
      <th>0</th>
      <td>papaya</td>
      <td>Fresh1</td>
      <td>0.308647</td>
      <td>0.646174</td>
      <td>1.298012</td>
      <td>fruit</td>
      <td>0.62</td>
    </tr>
    <tr>
      <th>0</th>
      <td>mangoes</td>
      <td>Fresh1</td>
      <td>0.363763</td>
      <td>0.705783</td>
      <td>1.377563</td>
      <td>fruit</td>
      <td>0.71</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">clean_df</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="s">"type"</span><span class="p">,</span> <span class="s">"price_per_lb"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>



                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2017/01/29/a2/" data-toggle="tooltip" data-placement="top" title="Assignment 2">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2017/02/16/a4/" data-toggle="tooltip" data-placement="top" title="Assignment 4">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/laic5">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:CynthiaLai1996@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy;  2017</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


    


</body>

</html>
